[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Item", 
  "modified": "2016-12-28 22:08:46.318884", 
  "name": "Item-Client", 
  "script": "frappe.ui.form.on(\"Item\", \"print_barcode\",\n    function(frm) {\n        var dialog = new frappe.ui.Dialog({\n            title: __(\"Barcode Lable \"),\n            fields: [{\n                \"fieldtype\": \"HTML\",\n                \"label\": __(\"Reason for losing\"),\n                \"fieldname\": \"reason\",\n                \"reqd\": 1,\n            }, ]\n        });\n        console.log(\"dialog.fields_dict.\", dialog.fields_dict);\n        $(dialog.fields_dict['reason'].wrapper).html(frappe.render(frappe.templates.barcode, \"\"));\n\n        setTimeout(function() {\n            var startIndex = 0;\n            var endIndex = 24;\n            console.log(\"bar code = \",frm.doc.barcode);\n            for (startIndex; startIndex < endIndex; startIndex++) {\n                $(\".cont\").append(\"<div class='barcode'><img src='http://www.barcodes4.me/barcode/c128a/\" + encodeURIComponent(frm.doc.barcode) + \".png?width=263&height=135&IsTextDrawn=1'/></div>\");\n            }\n            $(\".cont\").append(\"<div class='page-break'></div>\");\n            $('div .barcode').on('click', function() {\n                var $img = $(this).children()[0];\n                console.log(\"hh = \", $($img).css(\"height\"));\n                $(this).css(\"height\", \"140px\");\n                $($img).toggle('slow');\n            });\n        }, 100);\n\n        dialog.set_primary_action(__(\"Print\"), function() {\n\n            var printContents = $(dialog.fields_dict['reason'].wrapper).html();\n            // printContents = printContents.replace(\"width: inherit\",\"width: 8.27in\");\n            var xmlFromPage = $($.parseHTML(printContents));\n            xmlFromPage.find(\"html\").css(\"height\", \"11in\");\n            xmlFromPage.find(\"html\").css(\"width\", \"8.5in\");\n\n            w = window.open();\n            w.document.write(printContents);\n            setTimeout(function() {\n                $(w.document.body).css(\"margin\",\"0px\");\n                $(w.document).find(\".barcode\").css(\"outline\",\"0px\");\n\n                w.print();\n                w.close();\n            }, 100);\n        });\n        dialog.$wrapper.find('.modal-dialog').css(\"width\", \"870px\");\n        dialog.show();\n    });\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2016-12-30 11:52:27.765047", 
  "name": "Sales Invoice-Client", 
  "script": "\nfrappe.ui.form.on(\"Sales Invoice\", {\n    get_calculation: function(frm) {\n        var dialog = new frappe.ui.Dialog({\n            title: __(\"Set as Lost\"),\n            fields: [{\n                \"fieldtype\": \"Link\",\n                \"label\": __(\"\u0623\u062e\u062a\u0631 \u0631\u0642\u0645 \u0627\u0644\u0642\u064a\u0627\u0633\"),\n                \"fieldname\": \"calc\",\n                \"reqd\": 1,\n                \"options\": \"calculation\"\n            }, {\n                \"fieldtype\": \"Button\",\n                \"label\": __(\"\u0627\u062e\u062a\u0631\"),\n                \"fieldname\": \"update\"\n            }, ]\n        });\n        dialog.fields_dict.update.$input.click(function() {\n            arg = dialog.fields_list[0].input.value;\n            if (!arg) return;\n            return frappe.call({\n                method: \"frappe.client.get\",\n                args: {\n                    \"doctype\": \"calculation\",\n                    \"name\": arg\n                },\n                callback: function(r) {\n                    var row_name =\"\";\n                    if (frm.doc.items[0].item_code === undefined) {\n                      row_name= \"New Sales Invoice Item 1\";\n                    }else {\n                      row = frappe.model.add_child(frm.doc, 'Sales Invoice Item', \"items\");\n                      row_name = row.name;\n                    }\n                        if (r.message.total_m_price || r.message.total_f_price) {\n                            frappe.model.set_value(\"Sales Invoice Item\", row_name, \"item_code\", \"\u0639\u0645\u0644 \u0628\u0631\u0648\u0627\u0632\");\n                            setTimeout(function() {\n                                frappe.model.set_value(\"Sales Invoice Item\", row_name, \"qty\", (r.message.quantity_f));\n                                frappe.model.set_value(\"Sales Invoice Item\", row_name, \"rate\", (r.message.total_m_price + r.message.total_f_price));\n                            }, 100);\n                        } else if (r.message.total_g_price) {\n                            frappe.model.set_value(\"Sales Invoice Item\", row_name, \"item_code\", \"\u0639\u0645\u0644 \u0632\u062c\u0627\u062c\");\n                            setTimeout(function() {\n                                frappe.model.set_value(\"Sales Invoice Item\", row_name, \"qty\", (r.message.quantity_g));\n                                frappe.model.set_value(\"Sales Invoice Item\", row_name, \"rate\", r.message.total_g_price);\n                            }, 100);\n                        } else if (r.message.type == \"\u0643\u0627\u0646\u0641\u0627\u0633\") {\n                            frappe.model.set_value(\"Sales Invoice Item\", row_name, \"item_code\", \"\u0639\u0645\u0644 \u0643\u0627\u0646\u0641\u0627\u0633\");\n                            setTimeout(function() {\n                                frappe.model.set_value(\"Sales Invoice Item\", row_name, \"qty\", (r.message.quantity_c));\n                                frappe.model.set_value(\"Sales Invoice Item\", row_name, \"rate\", r.message.price);\n                            }, 100);\n                        }\n                    dialog.hide();\n                },\n                btn: this\n            });\n        });\n        dialog.show();\n    }\n});\n", 
  "script_type": "Client"
 }
]